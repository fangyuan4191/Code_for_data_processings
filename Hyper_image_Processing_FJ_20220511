{"cells":[{"cell_type":"code","execution_count":1,"id":"8938c779","metadata":{"id":"8938c779","executionInfo":{"status":"ok","timestamp":1652300936846,"user_tz":420,"elapsed":2085,"user":{"displayName":"Fangyuan Jiang","userId":"09141426764557996192"}}},"outputs":[],"source":["import numpy as np\n","import matplotlib.pyplot as plt\n","import os\n","from scipy.signal import savgol_filter\n","from numpy.core.function_base import linspace\n","from scipy.interpolate import InterpolatedUnivariateSpline\n","import statistics\n","import math\n","import h5py    #### The package used for creating and manipulating HDF5 files\n","import plotly   ###\n","import pandas as pd\n"]},{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"nGdAFSzxOI5w","executionInfo":{"status":"ok","timestamp":1652300956337,"user_tz":420,"elapsed":17891,"user":{"displayName":"Fangyuan Jiang","userId":"09141426764557996192"}},"outputId":"a64956f0-9d8c-4fb0-b80e-0cbef3334654"},"id":"nGdAFSzxOI5w","execution_count":2,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"cell_type":"code","execution_count":null,"id":"55e853ad","metadata":{"id":"55e853ad"},"outputs":[],"source":["# !pip install h5py\n","# !pip install mpldatacursor\n","# !pip install plotly==5.5.0"]},{"cell_type":"code","execution_count":3,"id":"95d1a881","metadata":{"id":"95d1a881","executionInfo":{"status":"ok","timestamp":1652300959829,"user_tz":420,"elapsed":169,"user":{"displayName":"Fangyuan Jiang","userId":"09141426764557996192"}}},"outputs":[],"source":["#@title 1- Costumize modules\n","def get_hyper_image(h5_data):\n","  ''' \n","  input: hyperspectal data taken from Photon etc hyperspectral microscopy\n","  data should be .h5 format\n","\n","  output:numpy array of hyperspectral image in a form of [width, height, wavenumber]\n","  ''' \n","  hf = h5py.File(h5_data, 'r')\n","  hf_im=np.array(hf['Cube']['Images'])\n","  hf_im=np.transpose(hf_im)\n","  hf_wl=np.array(hf['Cube']['Wavelength'])\n","\n","  return hf_im, hf_wl\n","\n"]},{"cell_type":"code","source":["###### to account for the detector responsivity\n","def data_correction(h5_data,cor_coef, wl_start,wl_stop,stepsize=2):      \n","  data_cor=np.zeros((h5_data.shape[0],h5_data.shape[1],h5_data.shape[2]))\n","  a_start =int((wl_start-600)/stepsize)\n","  a_stop=int(1+((wl_stop-600)/stepsize))\n","  cor_coef=cor_coef[a_start:a_stop]\n","  for x in range(data_cor.shape[0]):\n","      for y in range(data_cor.shape[1]):\n","          data_cor[x,y,:]=h5_data[x,y,:]*cor_coef    \n","          \n","  return data_cor "],"metadata":{"id":"eFWWBOB8rvxl","executionInfo":{"status":"ok","timestamp":1652300980526,"user_tz":420,"elapsed":145,"user":{"displayName":"Fangyuan Jiang","userId":"09141426764557996192"}}},"id":"eFWWBOB8rvxl","execution_count":4,"outputs":[]},{"cell_type":"code","source":["###### to calculate peak position and FWHM\n","def lin_interp(x, y, i, half):\n","    return x[i] + (x[i+1] - x[i]) * ((half - y[i]) / (y[i+1] - y[i]))   ##### \n","def half_max_x(x, y):\n","    half = max(y)/2.0\n","    signs = np.sign(np.add(y, -half))\n","    # print(signs)\n","    zero_crossings = (signs[0:-2] != signs[1:-1])\n","    # print(zero_crossings)\n","    zero_crossings_i = np.where(zero_crossings)[0]\n","    return [lin_interp(x, y, zero_crossings_i[0], half),\n","            lin_interp(x, y, zero_crossings_i[1], half)]\n","            \n","\n","def peak_fwhm_mapping(h5_data,wave,smoothing=True):\n","  '''\n","  Input\n","  h5_data: array of hyper image\n","  wave: array of wavelength\n","  smoothing: Boolean(True or False) If True, apply a Savitzky-Golay filter.\n","  Output\n","  max_peak_image:image array of max peak position\n","  fwhm_image:image array of full width half maximum at max intensity\n","   '''\n","  \n","  fwhm_image=np.zeros((h5_data.shape[0],h5_data.shape[1]))\n","  max_peak_image=np.zeros((h5_data.shape[0],h5_data.shape[1]))\n","  for x in range(fwhm_image.shape[0]):\n","      for y in range(fwhm_image.shape[1]):\n","          spec=h5_data[x,y,:]\n","          if smoothing ==True:\n","            spec = savgol_filter(h5_data[x,y,:], 5, 1)\n","          #max peak position\n","          wave_max=int(wave[np.argmax(spec)])\n","          max_peak_image[x,y]=wave_max\n","          #full width half max calculation\n","          hmx = half_max_x(wave,spec)\n","          fwhm = int(hmx[1] - hmx[0])\n","          fwhm_image[x,y] = fwhm\n","  return max_peak_image,fwhm_image   \n"],"metadata":{"id":"BSX9dUW1Yk99","executionInfo":{"status":"ok","timestamp":1652301020588,"user_tz":420,"elapsed":171,"user":{"displayName":"Fangyuan Jiang","userId":"09141426764557996192"}}},"id":"BSX9dUW1Yk99","execution_count":5,"outputs":[]},{"cell_type":"code","source":["file_directory_cor=''   #### load your correction file to account for the detector responsivity"],"metadata":{"id":"WgSbeaZXO25q","executionInfo":{"status":"ok","timestamp":1652301035045,"user_tz":420,"elapsed":160,"user":{"displayName":"Fangyuan Jiang","userId":"09141426764557996192"}}},"id":"WgSbeaZXO25q","execution_count":6,"outputs":[]},{"cell_type":"markdown","source":[""],"metadata":{"id":"4GVHFRvIuchc"},"id":"4GVHFRvIuchc"},{"cell_type":"code","source":["file_directory_1=''   #### load your own data that you would like to process"],"metadata":{"id":"jv4CrbyzbzI0","executionInfo":{"status":"ok","timestamp":1652301154454,"user_tz":420,"elapsed":135,"user":{"displayName":"Fangyuan Jiang","userId":"09141426764557996192"}}},"id":"jv4CrbyzbzI0","execution_count":8,"outputs":[]},{"cell_type":"code","source":["image_1, wavelength_1=get_hyper_image(file_directory_1)   ### read out your own data"],"metadata":{"id":"eMtzUlj2QRZO","executionInfo":{"status":"error","timestamp":1652301156254,"user_tz":420,"elapsed":194,"user":{"displayName":"Fangyuan Jiang","userId":"09141426764557996192"}},"colab":{"base_uri":"https://localhost:8080/","height":415},"outputId":"88c096e5-1a86-47da-bb0f-2ed80b3c6dcf"},"id":"eMtzUlj2QRZO","execution_count":9,"outputs":[{"output_type":"error","ename":"ValueError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)","\u001b[0;32m<ipython-input-9-eea33c769bd5>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mimage_1\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mwavelength_1\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mget_hyper_image\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfile_directory_1\u001b[0m\u001b[0;34m)\u001b[0m   \u001b[0;31m### read out your own data\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;32m<ipython-input-3-20e24bd3a6db>\u001b[0m in \u001b[0;36mget_hyper_image\u001b[0;34m(h5_data)\u001b[0m\n\u001b[1;32m      7\u001b[0m   \u001b[0moutput\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0mnumpy\u001b[0m \u001b[0marray\u001b[0m \u001b[0mof\u001b[0m \u001b[0mhyperspectral\u001b[0m \u001b[0mimage\u001b[0m \u001b[0;32min\u001b[0m \u001b[0ma\u001b[0m \u001b[0mform\u001b[0m \u001b[0mof\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0mwidth\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mheight\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mwavenumber\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      8\u001b[0m   ''' \n\u001b[0;32m----> 9\u001b[0;31m   \u001b[0mhf\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mh5py\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mFile\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mh5_data\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'r'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     10\u001b[0m   \u001b[0mhf_im\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0marray\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mhf\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'Cube'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'Images'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     11\u001b[0m   \u001b[0mhf_im\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtranspose\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mhf_im\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/h5py/_hl/files.py\u001b[0m in \u001b[0;36m__init__\u001b[0;34m(self, name, mode, driver, libver, userblock_size, swmr, rdcc_nslots, rdcc_nbytes, rdcc_w0, track_order, fs_strategy, fs_persist, fs_threshold, **kwds)\u001b[0m\n\u001b[1;32m    425\u001b[0m                                fapl, fcpl=make_fcpl(track_order=track_order, fs_strategy=fs_strategy,\n\u001b[1;32m    426\u001b[0m                                fs_persist=fs_persist, fs_threshold=fs_threshold),\n\u001b[0;32m--> 427\u001b[0;31m                                swmr=swmr)\n\u001b[0m\u001b[1;32m    428\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    429\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0misinstance\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mlibver\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtuple\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/h5py/_hl/files.py\u001b[0m in \u001b[0;36mmake_fid\u001b[0;34m(name, mode, userblock_size, fapl, fcpl, swmr)\u001b[0m\n\u001b[1;32m    188\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mswmr\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mswmr_support\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    189\u001b[0m             \u001b[0mflags\u001b[0m \u001b[0;34m|=\u001b[0m \u001b[0mh5f\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mACC_SWMR_READ\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 190\u001b[0;31m         \u001b[0mfid\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mh5f\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mopen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mname\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mflags\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mfapl\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mfapl\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    191\u001b[0m     \u001b[0;32melif\u001b[0m \u001b[0mmode\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0;34m'r+'\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    192\u001b[0m         \u001b[0mfid\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mh5f\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mopen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mname\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mh5f\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mACC_RDWR\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mfapl\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mfapl\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32mh5py/_objects.pyx\u001b[0m in \u001b[0;36mh5py._objects.with_phil.wrapper\u001b[0;34m()\u001b[0m\n","\u001b[0;32mh5py/_objects.pyx\u001b[0m in \u001b[0;36mh5py._objects.with_phil.wrapper\u001b[0;34m()\u001b[0m\n","\u001b[0;32mh5py/h5f.pyx\u001b[0m in \u001b[0;36mh5py.h5f.open\u001b[0;34m()\u001b[0m\n","\u001b[0;31mValueError\u001b[0m: Invalid file name (invalid file name)"]}]},{"cell_type":"code","source":["#### inteprete the correction file with any customized stepsize\n","\n","cor_file = np.genfromtxt(file_directory_cor, delimiter='\\t') #### load correction file\n","plt.plot(cor_file[:,0], cor_file[:,2])\n","\n","xdata=cor_file[2:,0]    ### wavelenth\n","ydata=cor_file[2:,2]    #### correction coefficient\n","\n","xs = np.linspace(600,1000, 201)  #### define the stepsize as 2   #### can also change to any other stepsizes too\n","spl = InterpolatedUnivariateSpline(xdata, ydata)   #### fitting the data\n","correction=[xs, spl(xs)]\n","wavelength=correction[0]\n","cor_coefficient = correction[1]"],"metadata":{"id":"-cIUWfzAO2m7","executionInfo":{"status":"ok","timestamp":1652301219226,"user_tz":420,"elapsed":393,"user":{"displayName":"Fangyuan Jiang","userId":"09141426764557996192"}},"colab":{"base_uri":"https://localhost:8080/","height":265},"outputId":"a9b939ce-9d00-42e7-8898-b487a3340f3d"},"id":"-cIUWfzAO2m7","execution_count":11,"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 1 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}}]},{"cell_type":"code","source":["###### to account for the detector responsivity\n","def data_correction(h5_data,cor_coef, wl_start,wl_stop,stepsize=2):      \n","  data_cor=np.zeros((h5_data.shape[0],h5_data.shape[1],h5_data.shape[2]))\n","  a_start =int((wl_start-600)/stepsize)\n","  a_stop=int(1+((wl_stop-600)/stepsize))\n","  cor_coef=cor_coef[a_start:a_stop]\n","  for x in range(data_cor.shape[0]):\n","      for y in range(data_cor.shape[1]):\n","          data_cor[x,y,:]=h5_data[x,y,:]*cor_coef    \n","          \n","  return data_cor  "],"metadata":{"id":"aRmPggrHaH3E","executionInfo":{"status":"ok","timestamp":1652301224353,"user_tz":420,"elapsed":140,"user":{"displayName":"Fangyuan Jiang","userId":"09141426764557996192"}}},"id":"aRmPggrHaH3E","execution_count":12,"outputs":[]},{"cell_type":"code","source":["data_cor1=data_correction(image_1,cor_coefficient, 720, 900,)    ##### data_correction(h5_data,wave_cor,wl_start,wl_stop,stepsize=2)"],"metadata":{"id":"FY3xng08bvSx"},"id":"FY3xng08bvSx","execution_count":null,"outputs":[]},{"cell_type":"code","source":["data_cor11 = data_cor1[100:900,300:1100,:]  ### select the range of the pixels that you want to look at"],"metadata":{"id":"FW-TyLJT9r49"},"id":"FW-TyLJT9r49","execution_count":null,"outputs":[]},{"cell_type":"code","source":["max_peak_image1,fwhm_image1 = peak_fwhm_mapping(data_cor11,wavelength_1,True)    #### read out peak position mapping and FWHM mapping"],"metadata":{"id":"G9U3QhuG-dg2","colab":{"base_uri":"https://localhost:8080/","height":165},"executionInfo":{"status":"error","timestamp":1652301265485,"user_tz":420,"elapsed":166,"user":{"displayName":"Fangyuan Jiang","userId":"09141426764557996192"}},"outputId":"1ed98a79-e235-4e48-f289-4b089269f444"},"id":"G9U3QhuG-dg2","execution_count":13,"outputs":[{"output_type":"error","ename":"NameError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-13-475464a80a03>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mmax_peak_image1\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0mfwhm_image1\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mpeak_median_offset_image1\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmedian_image1\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mpeak_fwhm_mapping\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata_cor11\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0mwavelength_1\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m)\u001b[0m    \u001b[0;31m#### read out peak position mapping and FWHM mapping\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;31mNameError\u001b[0m: name 'data_cor11' is not defined"]}]},{"cell_type":"code","execution_count":null,"id":"4ba96550","metadata":{"id":"4ba96550"},"outputs":[],"source":["#### define some parameters for your image\n","pv=0.3225 ### um   ### for objective lens 20x\n","Nx=1392   ###  how many pixels in the x-axis\n","Ny=1040   ###  how many pixels in the y-axis\n","stepsize= 2  ### define your stepsize\n","start_wl = 720   ### which wavelength does your imaging start with\n","\n","length = data_cor11.shape[0]    \n","width = data_cor11.shape[1]\n","\n"]},{"cell_type":"markdown","source":[""],"metadata":{"id":"8jCMBc4Ugc_5"},"id":"8jCMBc4Ugc_5"},{"cell_type":"code","execution_count":14,"id":"319c07a8","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":235},"id":"319c07a8","executionInfo":{"status":"error","timestamp":1652305530291,"user_tz":420,"elapsed":373,"user":{"displayName":"Fangyuan Jiang","userId":"09141426764557996192"}},"outputId":"a5734f42-0904-4380-b7d4-09d46396f728"},"outputs":[{"output_type":"error","ename":"NameError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-14-40d64efd6280>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0;31m#### plot PL intensity at PL peak\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 2\u001b[0;31m \u001b[0mmean_peak\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmax_peak_image1\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmean\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      3\u001b[0m \u001b[0;31m# print(mean_peak)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m \u001b[0mwl_in\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmean_peak\u001b[0m\u001b[0;34m-\u001b[0m\u001b[0mstart_wl\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m/\u001b[0m\u001b[0mstepsize\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m \u001b[0mdata_cor_intensity0\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdata_cor11\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0mwl_in\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mNameError\u001b[0m: name 'max_peak_image1' is not defined"]}],"source":["#### plot PL intensity at PL peak\n","mean_peak = max_peak_image1.mean()\n","# print(mean_peak)\n","wl_in=int((mean_peak-start_wl)/stepsize)\n","data_cor_intensity0 = data_cor11[:,:,wl_in]\n","# plt.imshow(image[:,:,wl_in],extent=[0,image.shape[1]*pv,0,image.shape[0]*pv] )\n","plt.imshow(data_cor_intensity0, extent=[0,length*pv,0,width*pv])#,cmap=\"RdBu_r\")\n","cbar=plt.colorbar()\n","cbar.set_label('Integrated Counts', rotation=270, fontsize=15, labelpad=13)\n","cbar.ax.tick_params(labelsize=13)\n","plt.xlabel(\" Length ($ \\u03bcm $)\", fontsize=15)\n","plt.ylabel(\" Length ($ \\u03bcm $)\", fontsize=15)\n","plt.xticks(fontsize=14)\n","plt.yticks(fontsize=14)\n"]},{"cell_type":"code","source":["#### plot PL peak mapping\n","\n","plt.imshow(max_peak_image1, extent=[0,length*pv,0,width*pv])\n","cbar=plt.colorbar()\n","cbar.set_label('PL peak (nm)', rotation=270, fontsize=15, labelpad=13)\n","cbar.ax.tick_params(labelsize=13)\n","plt.xlabel(\" Length ($ \\u03bcm $)\", fontsize=15)\n","plt.ylabel(\" Length ($ \\u03bcm $)\", fontsize=15)\n","plt.xticks(fontsize=14)\n","plt.yticks(fontsize=14)\n","plt.clim(750,790)\n","plt.xlim(100,200)\n","plt.ylim(150,250)\n","\n","# plt.text(10, 90, 'lambda=790 nm (filmside)', color=\"white\", size=12)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":241},"id":"glkTnboVPsZN","executionInfo":{"status":"error","timestamp":1648425209152,"user_tz":420,"elapsed":160,"user":{"displayName":"Fangyuan Jiang","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"09141426764557996192"}},"outputId":"2b6f78aa-db57-4892-99ff-887d20cb6f12"},"id":"glkTnboVPsZN","execution_count":null,"outputs":[{"output_type":"error","ename":"NameError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-20-58def94dbe7c>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0;31m#### plot PL peak mapping\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      2\u001b[0m \u001b[0;31m# plt.imshow(max_peak_image1)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 3\u001b[0;31m \u001b[0mplt\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mimshow\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmax_peak_image1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;31m#, extent=[0,length*pv,0,width*pv])\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      4\u001b[0m \u001b[0mcbar\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mplt\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcolorbar\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m \u001b[0mcbar\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mset_label\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'PL peak (nm)'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mrotation\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m270\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mfontsize\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m15\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlabelpad\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m13\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mNameError\u001b[0m: name 'max_peak_image1' is not defined"]}]},{"cell_type":"code","execution_count":null,"id":"480bef10","metadata":{"id":"480bef10"},"outputs":[],"source":["fig,ax=plt.subplots(figsize=(8,8))\n","\n","plt.plot(wavelength_1, data_cor11.mean(axis=(0,1))), linewidth = 3, color=\"red\", label=\"***\")\n","\n","plt.ylabel(\" Intentisty (a.u.)\", size=25)\n","plt.xticks(size=22)\n","plt.yticks(size= 22)\n","\n","plt.xlabel(\" Wavelength (nm)\", size=25)\n","plt.xlim([700, 850])\n","plt.legend(loc='upper left', labelspacing=0.4, handletextpad=0.4,fontsize=15)"]}],"metadata":{"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.8"},"colab":{"name":"Hyper_image_Processing_FJ_20220511","provenance":[{"file_id":"19zRS4PjcTNUYYkPYDqyLGpyiOp9sqt-O","timestamp":1652300910635},{"file_id":"1SDYfY6egQPRcUPu4htaQncMmmDutydY_","timestamp":1649810864697},{"file_id":"1bVx_cI6rQRkSKYmdWvB55V50uWfdEUXG","timestamp":1644346412297}],"collapsed_sections":[]}},"nbformat":4,"nbformat_minor":5}